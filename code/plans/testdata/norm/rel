ddl
(create-table abc
  [[a int] [b int] [c int]])
----
ok

ddl
(create-table xyz
  [[x int] [y int] [z int]])
----
ok

plan
xyz
----
-> Scan [1 2 3]

plan
(select xyz (= x 3))
----
-> Select
 -> Scan [1 2 3]
 -> Func (=)
  -> ColRef (1)
  -> Constant (3)

plan
(project xyz [(+ x 0)])
----
-> Project
 -> Scan [1 2 3]
 -> Func (+)
  -> ColRef (1)
  -> Constant (0)

plan
(join abc xyz (= a x))
----
-> Join
 -> Scan [1 2 3]
 -> Scan [4 5 6]
 -> Func (=)
  -> ColRef (1)
  -> ColRef (4)

plan
(select
 (join abc xyz (= a x))
 (= y 3))
----
-> Select
 -> Join
  -> Scan [1 2 3]
  -> Scan [4 5 6]
  -> Func (=)
   -> ColRef (1)
   -> ColRef (4)
 -> Func (=)
  -> ColRef (5)
  -> Constant (3)
